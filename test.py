import cv2
import matplotlib.pyplot as plt
import numpy as np
from math import *
import statistics


imgslog1 = []

# imgslog1.append(cv2.imread("../data/log1/362-rgb.png"))

for i in range (1,10):
    imgslog1.append(cv2.imread("../data/log1/00"+str(i)+"-rgb.png"))
for i in range (10,100):
    imgslog1.append(cv2.imread("../data/log1/0"+str(i)+"-rgb.png"))
for i in range (100,375):
    imgslog1.append(cv2.imread("../data/log1/"+str(i)+"-rgb.png"))


# imgslog2 = []

# for i in range (1,10):
#     imgslog2.append(cv2.imread("../data/log2/00"+str(i)+"-rgb.png"))
# for i in range (10,100):
#     imgslog2.append(cv2.imread("../data/log2/0"+str(i)+"-rgb.png"))
# for i in range (100,340):
#     imgslog2.append(cv2.imread("../data/log2/"+str(i)+"-rgb.png"))


# imgslog3 = []

# for i in range (1,10):
#     imgslog3.append(cv2.imread("../data/log3/00"+str(i)+"-rgb.png"))
# for i in range (10,100):
#     imgslog3.append(cv2.imread("../data/log3/0"+str(i)+"-rgb.png"))
# for i in range (100,265):
#     imgslog3.append(cv2.imread("../data/log3/"+str(i)+"-rgb.png"))

# imgslog4 = []

# for i in range (1,10):
#     imgslog4.append(cv2.imread("../data/log4/00"+str(i)+"-rgb.png"))
# for i in range (10,68):
#     imgslog4.append(cv2.imread("../data/log4/0"+str(i)+"-rgb.png"))

coords_center_algorithm = [[393.56307977736554, 218.89464617015636], [393.56307977736554, 218.89464617015636], [399.50000000000006, 218.89464617015636], [399.50000000000006, 218.89464617015636], [399.50000000000006, 218.89464617015636], [400.34813146037635, 218.89464617015636], [404.58878876225816, 249.42737874370528], [380.8411078717201, 239.24980121918895], [383.3855022528492, 212.1095944871455], [422.3995494301617, 232.4647495361781], [447.84349324145245, 224.83156639279088], [402.89252584150546, 220.59090909090907], [434.2733898754307, 200.23575404187648], [393.56307977736554, 218.89464617015636], [402.89252584150546, 200.23575404187648], [393.56307977736554, 176.48807315133843], [368.9672674264511, 211.26146302676915], [414.7663662867745, 225.67969785316723], [391.01868539623644, 243.49045852107076], [460.5654651470979, 229.92035515504904], [387.62615955473103, 200.23575404187648], [424.0958123509144, 187.5137821362311], [379.9929764113438, 190.05817651736015], [346.9158494566658, 211.26146302676915], [417.3107606679036, 215.5021203286509], [399.50000000000006, 240.0979326795653], [461.4135966074742, 236.7054068380599], [388.4742910151073, 249.42737874370528], [437.6659157169361, 207.02080572488734], [382.5373707924728, 193.4507023588656], [380.8411078717201, 184.12125629472564], [394.41121123774184, 183.2731248343493], [384.23363371322563, 240.94606413994165], [413.9182348263982, 245.18672144182347], [347.76398091704215, 247.73111582295252], [437.6659157169361, 204.4764113437583], [421.5514179697854, 153.58852372117678], [385.0817651736019, 183.2731248343493], [383.3855022528492, 213.8058574078982], [394.41121123774184, 268.0862708719851], [458.8692022263452, 274.871322554996], [354.549032600053, 244.33858998144711], [369.8153988868275, 240.94606413994165], [352.8527696793003, 208.71706864564004], [393.56307977736554, 218.04651470978], [435.9696527961834, 234.1610124569308], [380.8411078717201, 212.95772594752185], [454.62854492446337, 208.71706864564004], [378.2967134905911, 193.4507023588656], [336.73827193214953, 177.33620461171478], [379.9929764113438, 200.23575404187648], [366.4228730453221, 238.4016697588126], [446.14723032069975, 221.43904055128542], [349.4602438377949, 217.19838324940366], [403.74065730188187, 214.65398886827455], [373.2079247283329, 218.89464617015636], [356.24529552080577, 200.23575404187648], [459.7173336867215, 233.31288099655444], [394.41121123774184, 230.7684866154254], [428.3364696527962, 212.1095944871455], [379.9929764113438, 173.09554730983302], [385.0817651736019, 229.92035515504904], [461.4135966074742, 214.65398886827455], [361.3340842830639, 220.59090909090907], [368.1191359660748, 212.1095944871455], [376.6004505698383, 227.37596077391993], [407.9813146037637, 269.7825337927378], [463.9579909886033, 261.3012191889743], [390.17055393586014, 234.1610124569308], [447.84349324145245, 201.93201696262918], [361.3340842830639, 190.05817651736015], [345.2195865359131, 202.78014842300553], [399.50000000000006, 224.83156639279088], [384.23363371322563, 276.56758547574873], [447.84349324145245, 244.33858998144711], [344.37145507553674, 250.27551020408163], [430.8808640339253, 208.71706864564004], [334.1938775510204, 218.89464617015636], [442.75470447919434, 209.5652001060164], [385.92989663397833, 205.32454280413464], [426.6402067320435, 208.71706864564004], [390.17055393586014, 207.8689371852637], [369.8153988868275, 235.00914391730714], [430.0327325735489, 252.81990458521068], [396.10747415849465, 245.18672144182347], [480.0724887357541, 221.43904055128542], [360.4859528226876, 217.19838324940366], [442.75470447919434, 226.52782931354358], [379.9929764113438, 228.22409223429628], [372.3597932679566, 217.19838324940366], [402.04439438112917, 243.49045852107076], [408.82944606414, 227.37596077391993], [459.7173336867215, 228.22409223429628], [404.58878876225816, 244.33858998144711], [460.5654651470979, 190.05817651736015], [356.24529552080577, 208.71706864564004], [395.25934269811825, 218.89464617015636], [357.09342698118206, 226.52782931354358], [362.1822157434403, 272.3269281738669], [446.14723032069975, 247.73111582295252], [444.45096739994705, 276.56758547574873], [460.5654651470979, 259.60495626822154], [385.0817651736019, 230.7684866154254], [372.3597932679566, 234.1610124569308], [335.8901404717731, 225.67969785316723], [409.6775775245164, 212.95772594752185], [417.3107606679036, 208.71706864564004], [398.65186853962365, 251.12364166445798], [428.3364696527962, 246.03485290219982], [376.6004505698383, 254.51616750596338], [341.82706069440763, 244.33858998144711], [417.3107606679036, 231.61661807580174], [396.95560561887095, 208.71706864564004], [391.01868539623644, 233.31288099655444], [465.654253909356, 247.73111582295252], [415.6144977471509, 274.871322554996], [393.56307977736554, 239.24980121918895], [461.4135966074742, 253.66803604558703], [403.74065730188187, 249.42737874370528], [385.92989663397833, 251.12364166445798], [446.14723032069975, 261.3012191889743], [387.62615955473103, 256.2124304267161], [386.7780280943546, 273.17505963424327], [457.17293930559237, 293.53021468327586], [403.74065730188187, 267.2381394116088], [409.6775775245164, 269.7825337927378], [442.75470447919434, 288.44142592101775], [403.74065730188187, 309.6447124304267], [481.7687516565068, 324.9110787172011], [386.7780280943546, 355.44381129075003], [428.3364696527962, 356.2919427511264], [413.9182348263982, 402.0910416114497], [403.74065730188187, 397.85038430956797], [447.84349324145245, 397.00225284919156], [356.24529552080577, 422.4461966604823], [397.80373707924736, 412.26861913596605], [420.703286509409, 429.2312483434932], [357.94155844155847, 417.3574078982242], [274.82467532467535, 439.4088258680095], [322.3200371057514, 442.80135170951496], [273.1284124039226, 442.80135170951496], [240.05128544924463, 444.49761463026766], [306.2055393586006, 444.49761463026766], [546.2267426451101, 441.1050887887622], [498.73138086403395, 413.1167505963424], [578.4557381394118, 443.64948316989125], [564.8856347733899, 413.96488205671875], [550.4673999469919, 173.09554730983302], [632.7361516034987, 257.90869334746884], [551.3155314073683, 201.93201696262918], [649.6987808110259, 229.07222369467263], [278.21720116618076, 151.04412934004768], [290.93917307182613, 113.72634508348796], [366.4228730453221, 82.3454810495627], [283.3059899284389, 91.67492711370261], [27.170288894778622, 178.18433607209118], [0.8782136231115203, 240.0979326795653], [15.296448449509626, 134.08150013252055], [None, None], [None, None], [None, None], [None, None], [None, None], [None, None], [None, None], [782.0072886297378, 444.49761463026766], [None, None], [None, None], [379.9929764113438, 433.471905645375], [460.5654651470979, 427.5349854227405], [395.25934269811825, 234.1610124569308], [376.6004505698383, 140.01842035515506], [411.3738404452691, 136.6258945136496], [376.6004505698383, 166.31049562682216], [393.56307977736554, 169.70302146832756], [415.6144977471509, 157.82918102305854], [371.5116618075802, 199.38762258150012], [371.5116618075802, 212.1095944871455], [435.12152133580713, 217.19838324940366], [381.6892393320965, 240.94606413994165], [362.1822157434403, 240.94606413994165], [420.703286509409, 268.9344023323615], [398.65186853962365, 227.37596077391993], [349.4602438377949, 247.73111582295252], [399.50000000000006, 300.3152663662868], [357.94155844155847, 266.3900079512324], [339.2826663132786, 272.3269281738669], [402.04439438112917, 269.7825337927378], [358.7896899019349, 256.2124304267161], [324.8644314868805, 296.07460906440497], [393.56307977736554, 291.83395176252316], [320.6237741849987, 320.6704214153193], [340.9789292340313, 313.0372382719321], [416.4626292075272, 251.12364166445798], [371.5116618075802, 250.27551020408163], [404.58878876225816, 271.47879671349057], [435.12152133580713, 275.7194540153723], [407.13318314338727, 242.6423270606944], [441.05844155844164, 286.74516300026505], [362.1822157434403, 251.12364166445798], [416.4626292075272, 244.33858998144711], [421.5514179697854, 274.871322554996], [340.13079777365493, 261.3012191889743], [406.28505168301086, 295.22647760402856], [406.28505168301086, 281.65637423800683], [400.34813146037635, 251.12364166445798], [442.75470447919434, 255.36429896633973], [374.9041876490856, 271.47879671349057], [378.2967134905911, 246.88298436257617], [379.1448449509674, 232.4647495361781], [366.4228730453221, 186.66565067585475], [424.0958123509144, 223.98343493241453], [395.25934269811825, 270.6306652531142], [444.45096739994705, 243.49045852107076], [481.7687516565068, 212.1095944871455], [435.12152133580713, 223.13530347203817], [393.56307977736554, 208.71706864564004], [455.47667638483966, 225.67969785316723], [362.1822157434403, 223.98343493241453], [368.9672674264511, 218.89464617015636], [400.34813146037635, 229.92035515504904], [343.5233236151604, 250.27551020408163], [435.9696527961834, 256.2124304267161], [384.23363371322563, 245.18672144182347], [387.62615955473103, 302.0115292870395], [465.654253909356, 317.2778955738139], [352.8527696793003, 313.0372382719321], [460.5654651470979, 366.4695202756427], [345.2195865359131, 400.394778690697], [407.9813146037637, 403.7873045322025], [331.64948316989137, 329.15173601908293], [355.39716406042936, 323.2148157964484], [186.61900344553402, 137.47402597402595], [None, None], [None, None], [None, None], [None, None], [None, None], [None, None], [None, None], [None, None], [None, None], [None, None], [None, None], [None, None], [None, None], [None, None], [None, None], [None, None], [None, None], [None, None], [None, None], [None, None], [None, None], [None, None], [None, None], [None, None], [None, None], [None, None], [None, None], [None, None], [None, None], [None, None], [None, None], [None, None], [None, None], [None, None], [None, None], [None, None], [726.0306122448981, 349.5068910681155], [726.0306122448981, 366.4695202756427], [413.0701033660218, 213.8058574078982], [277.3690697058044, 125.60018552875692], [193.40405512854488, 137.47402597402595], [324.8644314868805, 169.70302146832756], [413.9182348263982, 223.13530347203817], [405.43692022263457, 235.8572753776835], [398.65186853962365, 256.2124304267161], [359.6378213623112, 283.3526371587596], [368.1191359660748, 222.28717201166177], [316.3831168831169, 227.37596077391993], [387.62615955473103, 202.78014842300553], [441.05844155844164, 223.98343493241453], [395.25934269811825, 239.24980121918895], [444.45096739994705, 229.92035515504904], [449.53975616220515, 253.66803604558703], [381.6892393320965, 257.90869334746884], [434.2733898754307, 236.7054068380599], [417.3107606679036, 266.3900079512324], [377.4485820302147, 259.60495626822154], [452.93228200371067, 261.3012191889743], [383.3855022528492, 207.8689371852637], [340.13079777365493, 222.28717201166177], [407.9813146037637, 226.52782931354358], [363.878478664193, 296.07460906440497], [434.2733898754307, 298.619003445534], [427.4883381924199, 279.1119798568778], [391.86681685661284, 244.33858998144711], [451.23601908295797, 210.4133315663928], [420.703286509409, 187.5137821362311], [369.8153988868275, 238.4016697588126], [441.05844155844164, 278.26384839650143], [395.25934269811825, 293.53021468327586], [449.53975616220515, 290.13768884177045], [None, None], [None, None], [None, None], [379.9929764113438, 444.49761463026766], [301.11675059634246, 442.80135170951496], [298.57235621521335, 437.71256294725674], [323.16816856612775, 421.59806520010596], [241.74754836999733, 415.66114497747145], [349.4602438377949, 205.32454280413464], [474.9836999734959, 146.80347203816592], [488.55380333951774, 144.2590776570368], [496.18698648290496, 186.66565067585475], [449.53975616220515, 222.28717201166177], [346.9158494566658, 226.52782931354358], [395.25934269811825, 247.73111582295252], [406.28505168301086, 293.53021468327586], [416.4626292075272, 303.7077922077922], [502.12390670553947, 306.2521865889213], [430.0327325735489, 233.31288099655444], [436.81778425655983, 271.47879671349057], [365.5747415849457, 283.3526371587596], [390.17055393586014, 444.49761463026766], [411.3738404452691, 443.64948316989125], [427.4883381924199, 391.91346408693346], [449.53975616220515, 227.37596077391993], [337.5864033925259, 50.96461701563743], [376.6004505698383, 74.71229790617548], [327.40882586800956, 89.13053273257356], [500.42764378478665, 182.42499337397294], [396.10747415849465, 180.72873045322024], [414.7663662867745, 216.35025178902725], [384.23363371322563, 271.47879671349057], [386.7780280943546, 302.0115292870395], [460.5654651470979, 315.5816326530612], [223.08865624171744, 320.6704214153193], [326.5606944076332, 312.18910681155575], [323.16816856612775, 261.3012191889743], [276.52093824542806, 255.36429896633973], [449.53975616220515, 188.36191359660745], [499.57951232441036, 164.6142327060694], [513.149615690432, 179.8805989928439], [519.0865359130667, 199.38762258150012], [441.90657301881794, 202.78014842300553], [462.2617280678506, 240.94606413994165], [446.99536178107616, 274.871322554996], [395.25934269811825, 259.60495626822154], [447.84349324145245, 264.6937450304797], [413.9182348263982, 273.17505963424327], [385.92989663397833, 324.06294725682477], [463.9579909886033, 402.0910416114497], [285.0022528491916, 441.1050887887622], [441.05844155844164, 195.1469652796183], [494.49072356215214, 125.60018552875692], [441.05844155844164, 64.53472038165916], [485.1612774980122, 79.80108666843358], [464.8061224489797, 120.51139676649882], [469.8949112112378, 86.58613835144445], [519.9346673734431, 107.78942486085344], [470.7430426716142, 137.47402597402595], [542.8342168036047, 164.6142327060694], [495.33885502252855, 187.5137821362311], [495.33885502252855, 193.4507023588656], [547.9230055658627, 185.8175192154784], [349.4602438377949, 255.36429896633973], [419.0070235886563, 236.7054068380599], [372.3597932679566, 254.51616750596338], [505.5164325470449, 288.44142592101775], [522.4790617545721, 315.5816326530612], [466.5023853697324, 345.26623376623377], [525.8715875960775, 386.8246753246753]] #Mettre les coordonnées des centres trouvées par l'algorithm
radius_algorithm     = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 52.800003, 23.099998, 0, 0, 0, 0, 0, 85.8, 0, 0, 0, 0, 0, 0, 75.899994, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 29.699999, 0, 0, 0, 0, 142.79999, 0, 89.100006, 0, 0, 0, 0, 79.8, 200.70001, 0, 0, 0, 0, 86.399994, 0, 150.6, 0, 0, 0, 0, 0, 0, 219.29999, 0, 0, 0, 0, 0, 275.7, 177.29999, 0, 295.8, 21.0, 305.40002, 0, 320.40002, 0, 0, 277.5, 24.300001, 255.90001, 24.900002, 361.5, 27.599998, 27.0, 28.5, 29.099998, 30.300001, 28.800001, 33.6, 33.9, 35.1, 37.199997, 36.300003, 39.9, 37.800003, 406.19998, 43.199997, 40.800003, 42.0, 43.800003, 44.1, 45.300003, 46.800003, 48.899998, 50.399998, 54.899998, 52.199997, 56.100002, 56.699997, 59.100002, 65.7, 60.0, 61.5, 69.0, 75.3, 73.8, 76.5, 48.300003, 107.399994, 83.7, 104.700005, 80.7, 97.799995, 85.5, 81.899994, 89.399994, 79.8, 0, 75.3, 0, 84.3, 90.899994, 78.0, 89.100006, 89.399994, 92.399994, 84.899994, 93.0, 70.8, 75.899994, 79.2, 69.3, 82.5, 389.69998, 187.20001, 0, 325.2, 65.7, 331.5, 336.0, 106.200005, 107.399994, 92.399994, 93.3, 145.5, 56.399998, 57.899998, 52.5, 52.800003, 52.800003, 51.600002, 53.399998, 53.100002, 56.100002, 54.899998, 53.699997, 52.5, 54.600002, 53.699997, 56.699997, 58.5, 58.5, 59.399998, 60.0, 59.399998, 62.399998, 65.7, 66.600006, 69.899994, 69.0, 65.7, 64.5, 68.399994, 69.3, 71.100006, 69.3, 64.2, 69.3, 68.7, 67.2, 71.100006, 66.600006, 65.399994, 67.5, 64.2, 67.8, 68.7, 0, 68.399994, 64.5, 67.8, 69.899994, 69.0, 65.399994, 68.7, 64.5, 69.600006, 73.5, 69.3, 73.5, 72.899994, 85.2, 83.100006, 77.7, 91.5, 96.600006, 88.5, 93.3, 79.5, 85.2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 246.59999, 262.5, 227.40001, 209.40001, 29.400002, 0, 114.899994, 102.0, 82.2, 0, 0, 141.9, 170.4, 189.29999, 52.199997, 56.699997, 217.20001, 0, 96.299995, 0, 224.70001, 211.5, 150.6, 37.199997, 45.300003, 47.1, 42.6, 42.9, 42.6, 44.1, 48.600002, 49.800003, 57.0, 42.0, 48.0, 45.0, 44.1, 76.5, 45.300003, 83.100006, 69.600006, 70.5, 70.2, 74.100006, 83.100006, 82.5, 88.8, 86.100006, 84.600006, 0, 0, 0, 0, 65.7, 85.2, 74.399994, 77.7, 62.399998, 72.600006, 68.7, 70.5, 68.7, 64.5, 70.8, 71.7, 72.3, 79.2, 75.3, 82.2, 84.899994, 0, 72.3, 74.7, 68.7, 63.0, 76.8, 78.0, 80.7, 75.0, 76.5, 76.2, 80.399994, 82.8, 87.3, 83.7, 72.600006, 69.899994, 73.5, 74.399994, 79.2, 78.600006, 75.3, 79.2, 81.3, 77.399994, 82.5, 79.8, 87.3, 84.0, 89.7, 82.5, 85.8, 81.899994, 84.3, 77.7, 73.5, 74.100006, 76.8, 77.100006, 74.100006, 74.100006, 91.2, 79.2, 70.2, 82.8, 80.100006, 89.100006, 91.8, 88.5]
coords_center_test = [[393.56307977736554, 218.89464617015636]]
coords_center = [[None, None],[None, None],[None, None],[None, None],[None, None],[None, None],[None, None],[None, None],[None, None],[None, None],[None, None],[None, None],[184.5, 209.5],[127.5, 191.5],[None, None],[None, None],[None, None],[None, None],[None, None],[148.5, 230.5],[None, None],[None, None],[None, None],[None, None],[None, None],[None, None],[124.5, 254.5],[None, None],[None, None],[None, None],[None, None],[None, None],[None, None],[None, None],[None, None],[None, None],[None, None],[None, None],[None, None],[None, None],[None, None],[None, None],[None, None],[None, None],[None, None],[None, None],[None, None],[166.5, 163.5],[None, None],[None, None],[None, None],[None, None],[319.5, 285.5],[None, None],[121.5, 233.5],[None, None],[None, None],[None, None],[None, None],[124.5, 214.5],[232.5, 311.5],[None, None],[None, None],[None, None],[None, None],[79.5, 226.5],[None, None],[334.5, 315.5],[None, None],[None, None],[None, None],[None, None],[None, None],[None, None],[301.5, 387.5],[None, None],[None, None],[None, None],[None, None],[None, None],[241.5, 391.5],[214.5, 283.5],[None, None],[232.5, 448.5],[394.5, 241.5],[277.5, 423.5],[None, None],[229.5, 436.5],[None, None],[None, None],[130.5, 379.5],[409.5, 226.5],[190.5, 336.5],[403.5, 245.5],[247.5, 399.5],[355.5, 205.5],[388.5, 215.5],[355.5, 228.5],[361.5, 269.5],[448.5, 244.5],[442.5, 271.5],[460.5, 254.5],[376.5, 224.5],[370.5, 232.5],[337.5, 220.5],[409.5, 211.5],[418.5, 202.5],[397.5, 246.5],[97.5, 409.5],[376.5, 253.5],[343.5, 238.5],[418.5, 226.5],[397.5, 202.5],[388.5, 229.5],[457.5, 241.5],[415.5, 274.5],[391.5, 232.5],[460.5, 250.5],[406.5, 247.5],[382.5, 244.5],[445.5, 256.5],[391.5, 253.5],[385.5, 265.5],[454.5, 292.5],[406.5, 259.5],[403.5, 265.5],[439.5, 286.5],[394.5, 307.5],[478.5, 322.5],[382.5, 358.5],[436.5, 388.5],[439.5, 412.5],[397.5, 400.5],[445.5, 421.5],[355.5, 424.5],[394.5, 430.5],[418.5, 430.5],[358.5, 421.5],[280.5, 448.5],[322.5, 442.5],[None, None],[247.5, 442.5],[None, None],[538.5, 448.5],[493.5, 433.5],[562.5, 448.5],[562.5, 430.5],[541.5, 172.5],[628.5, 262.5],[553.5, 205.5],[643.5, 229.5],[280.5, 157.5],[286.5, 112.5],[364.5, 85.5],[289.5, 95.5],[43.5, 174.5],[424.5, 112.5],[538.5, 256.5],[None, None],[349.5, 434.5],[184.5, 185.5],[376.5, 446.5],[373.5, 418.5],[286.5, 71.5],[265.5, 189.5],[226.5, 88.5],[274.5, 93.5],[262.5, 203.5],[379.5, 437.5],[451.5, 432.5],[391.5, 232.5],[373.5, 139.5],[406.5, 136.5],[370.5, 166.5],[388.5, 172.5],[412.5, 154.5],[370.5, 205.5],[367.5, 208.5],[427.5, 217.5],[382.5, 241.5],[355.5, 244.5],[415.5, 268.5],[397.5, 226.5],[349.5, 247.5],[397.5, 304.5],[355.5, 268.5],[337.5, 271.5],[400.5, 265.5],[358.5, 253.5],[325.5, 298.5],[388.5, 286.5],[319.5, 325.5],[337.5, 310.5],[415.5, 250.5],[367.5, 253.5],[403.5, 274.5],[427.5, 274.5],[403.5, 244.5],[436.5, 280.5],[358.5, 244.5],[412.5, 238.5],[418.5, 268.5],[337.5, 262.5],[403.5, 289.5],[403.5, 280.5],[394.5, 253.5],[439.5, 265.5],[370.5, 274.5],[373.5, 247.5],[376.5, 235.5],[None, None],[412.5, 223.5],[388.5, 268.5],[436.5, 247.5],[475.5, 214.5],[433.5, 223.5],[388.5, 214.5],[454.5, 229.5],[358.5, 226.5],[364.5, 220.5],[394.5, 235.5],[337.5, 250.5],[424.5, 250.5],[376.5, 247.5],[385.5, 298.5],[457.5, 310.5],[337.5, 304.5],[457.5, 352.5],[349.5, 394.5],[403.5, 403.5],[331.5, 331.5],[355.5, 322.5],[190.5, 130.5],[None, None],[None, None],[None, None],[None, None],[None, None],[None, None],[None, None],[None, None],[None, None],[None, None],[None, None],[None, None],[None, None],[None, None],[None, None],[None, None],[None, None],[None, None],[None, None],[None, None],[None, None],[None, None],[529.5, 208.5],[535.5, 172.5],[562.5, 202.5],[520.5, 238.5],[748.5, 301.5],[None, None],[121.5, 227.5],[136.5, 250.5],[112.5, 175.5],[None, None],[None, None],[73.5, 216.5],[274.5, 270.5],[214.5, 247.5],[724.5, 355.5],[721.5, 375.5],[694.5, 127.5],[None, None],[598.5, 358.5],[None, None],[226.5, 235.5],[190.5, 234.5],[172.5, 183.5],[355.5, 276.5],[364.5, 223.5],[313.5, 229.5],[391.5, 199.5],[442.5, 217.5],[394.5, 235.5],[448.5, 226.5],[448.5, 250.5],[385.5, 256.5],[430.5, 235.5],[406.5, 274.5],[370.5, 259.5],[445.5, 268.5],[400.5, 205.5],[358.5, 205.5],[430.5, 247.5],[382.5, 289.5],[430.5, 292.5],[421.5, 274.5],[391.5, 238.5],[448.5, 208.5],[412.5, 184.5],[364.5, 247.5],[439.5, 271.5],[391.5, 295.5],[445.5, 292.5],[None, None],[None, None],[None, None],[None, None],[307.5, 445.5],[298.5, 445.5],[322.5, 421.5],[247.5, 433.5],[346.5, 202.5],[466.5, 142.5],[481.5, 142.5],[490.5, 184.5],[442.5, 220.5],[340.5, 229.5],[388.5, 247.5],[397.5, 289.5],[409.5, 298.5],[490.5, 298.5],[421.5, 229.5],[433.5, 268.5],[358.5, 280.5],[None, None],[409.5, 445.5],[430.5, 394.5],[445.5, 229.5],[340.5, 73.5],[373.5, 70.5],[328.5, 88.5],[493.5, 172.5],[391.5, 175.5],[409.5, 214.5],[382.5, 262.5],[379.5, 298.5],[457.5, 310.5],[220.5, 328.5],[331.5, 316.5],[328.5, 256.5],[277.5, 262.5],[445.5, 190.5],[490.5, 169.5],[508.5, 187.5],[514.5, 208.5],[436.5, 211.5],[460.5, 235.5],[439.5, 277.5],[394.5, 259.5],[442.5, 265.5],[406.5, 268.5],[382.5, 322.5],[466.5, 394.5],[286.5, 445.5],[439.5, 196.5],[490.5, 115.5],[439.5, 58.5],[481.5, 73.5],[460.5, 106.5],[469.5, 94.5],[526.5, 97.5],[469.5, 133.5],[541.5, 157.5],[499.5, 184.5],[493.5, 184.5],[538.5, 178.5],[349.5, 250.5],[427.5, 235.5],[367.5, 247.5],[505.5, 286.5],[517.5, 313.5],[460.5, 352.5],[520.5, 373.5]]
coords_radius = []
radius_test = [9.482397996288524]
radius = [9.482397996288524, 9.482397996288524, 7.819385704568587, 8.396073097576823, 8.481314603763565, 8.481314603763554, 8.649277733102029, 9.482397996288524, 8.481314603763554, 12.054212905212287, 10.62705673884266, 9.670186483745665, 9.17394440616334, 9.015761092168269, 10.861382220930302, 9.015761092168312, 9.670186483745665, 10.79495112545589, 10.62705673884266, 9.670186483745665, 10.35276384053745, 9.670186483745665, 11.155427670684, 10.248011427379453, 10.861382220930373, 10.248011427379424, 10.352763840537405, 11.025708984892644, 10.35276384053745, 12.608380596718552, 13.410135850170665, 10.79495112545589, 11.05828131282716, 9.173944406163372, 11.813104290217066, 14.418234826398065, 12.608380596718632, 12.054212905212287, 9.890827491918838, 11.410441810399098, 10.861382220930418, 10.861382220930384, 11.535835045839772, 14.591805382738615, 13.910390218378387, 11.535835045839738, 11.813104290217138, 13.910390218378343, 15.100551340378418, 12.721971905645376, 12.608380596718552, 13.80657988537486, 13.806579885374783, 13.806579885374822, 14.591805382738649, 15.00497727046201, 13.806579885374822, 14.393268167274535, 13.248236927061335, 15.638771409137174, 15.638771409137174, 17.173353177899067, 16.29207333139548, 16.792146195153606, 15.638771409137174, 15.17183679406162, 15.934943421621798, 15.776157105953452, 18.67815789709641, 17.484677977705392, 17.648472448818254, 16.834928802569177, 17.99158520909322, 22.40736994624615, 19.191024223032713, 17.648472448818335, 17.99158520909322, 19.781654983837754, 19.191024223032713, 19.872355390592134, 21.58990225091178, 20.5135633139852, 22.11656262565437, 23.565237617937644, 24.478549168787612, 22.2624411316732, 23.165015058570162, 25.216761193437222, 24.301593481082463, 23.565237617937694, 24.46385174976897, 24.595812350914372, 25.216761193437105, 24.958709092286743, 27.781969749965235, 29.18361076547722, 30.591573893447446, 28.78653633454903, 30.872451160479283, 29.67248247575662, 32.00502477877668, 35.510282814453596, 34.80440524345944, 36.08298522967638, 39.708496914182675, 37.66314900384761, 41.06217757552362, 42.78652999524435, 45.14258873357861, 44.00486580167832, 45.33340010353232, 47.767197550015275, 49.395921856766805, 48.04498162995954, 52.316719472601754, 49.23547402686458, 53.43901278184442, 55.03059658841947, 58.576357571653766, 57.59805556143003, 60.3128220855503, 59.520461585446895, 67.85581744468881, 67.00775307535834, 63.81308643427026, 65.70692884642354, 67.17393920565242, 78.18005691197023, 77.24983221320801, 79.94060818962984, 82.05425325594068, 87.55904801758682, 83.22499284119898, 81.70284156296916, 82.33867093113214, 79.83706105139439, 83.63883561438014, 81.17287159250951, 81.49126716837702, 78.87622581500136, 57.77263331138567, 75.55989804965348, 50.894954894002645, 75.6550377222537, 72.17095412500967, 68.74575055744519, 73.23456778558527, 85.86257716460233, 86.92416543020545, 80.41162956939941, 95.95512111516365, 75.75480578294226, 80.32212416591538, 82.83947931224878, 78.84430042812556, 96.46726420747457, 61.91940545456745, 96.74648617252569, 0, 0, 0, 0, 0, 0, 0, 14.2172739903442, 0, 0, 51.141694122852144, 54.51842859895284, 54.9390205886512, 54.18756968341637, 55.51861024857678, 51.50609556554968, 50.06849812675894, 56.881743375290824, 53.08110546580473, 56.079385969162935, 54.10121493582258, 54.604123539913665, 54.735699931980015, 55.912387083295464, 58.52721632343023, 57.679175229198805, 57.679175229198805, 57.897009415110766, 59.46605253905742, 66.09442271166795, 63.041902983592884, 64.55834948184702, 67.00775307535834, 69.46916344036126, 71.85630814303782, 70.16974517253516, 71.48998636759804, 69.62947511866011, 75.86866577572881, 71.56541102690994, 75.14463884089841, 69.96441994767997, 72.84061889368506, 72.21579163923207, 67.17393920565239, 74.05989587733038, 67.06676948327743, 66.91106849150405, 65.65764658942817, 66.06720880072243, 71.01043647451935, 68.29960048865343, 74.6548417396547, 74.05503933147929, 67.17393920565239, 72.12608873734615, 74.71263158838572, 69.03289942687395, 65.98004885670345, 66.50129499975668, 62.8132824554611, 70.29265242510373, 71.13189112964498, 73.63129364368099, 85.37107766322215, 79.38981639284813, 84.80042311143917, 93.19031364937808, 90.78572833331336, 103.0401190673943, 101.39339778088748, 89.01744742726991, 89.45676378363738, 78.80323449728314, 69.12141319330969, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 47.80483026486534, 48.22431033411545, 41.59304476306974, 41.02712662797034, 42.82014078596963, 37.644045198913744, 40.114018011379315, 39.70849691418262, 40.78092647394448, 42.651821971032604, 44.03754673139773, 46.143340183359044, 47.138105847960546, 47.03881133989784, 47.13810584796057, 48.94240312537636, 56.22030526516294, 54.30691110465177, 54.51842859895284, 60.23524929192371, 55.2914065641359, 57.679175229198904, 65.01357781029182, 64.5081897517949, 67.64878571783689, 76.35067647339746, 73.1805255653893, 72.95902691369311, 73.98701421702208, 77.6769892476799, 81.70724353714137, 75.6550377222537, 84.68583076039897, 83.99927552516172, 80.87101364726782, 0, 0, 0, 49.4541374595944, 61.441256171830894, 76.3506764733974, 73.909194564442, 61.65163202251362, 61.11845037628277, 69.62947511866011, 70.16974517253509, 70.64481966972505, 65.22345992593392, 63.12742222207355, 72.27055526835153, 74.85210619020789, 75.38834407391596, 81.4603666569777, 76.77346693756002, 79.22201618773137, 85.7284299061678, 35.621521335807074, 68.7038834703966, 72.93930559236685, 66.4201199338985, 72.86530309883763, 76.37422623382712, 81.67642473577772, 84.35391175043803, 72.215791639232, 81.46036665697763, 76.7125411842782, 84.83010697091959, 90.00189473070215, 89.85791720293491, 78.54723073848824, 72.46438373977233, 65.8709367449057, 70.83801924943278, 74.98172863711754, 77.75566356956591, 80.44293293276236, 73.76793720117303, 82.33867093113219, 82.4826922502528, 78.03270362859622, 84.21736141930668, 79.79650602975887, 87.84611418800307, 89.31593442689102, 83.9992755251617, 81.46036665697765, 88.35641261216803, 76.1100527017773, 79.67471710810894, 88.53533778413694, 85.05452003464544, 87.39458685057599, 84.88096943594967, 83.18608952613941, 82.26875165650677, 82.26875165650677, 95.03993273105915, 80.50550314395909, 83.53556712892652, 77.68161935463395, 79.53013317659307, 89.91793585631683, 85.05452003464548, 97.52036671543775]
verification_rates = []

def onclick_center(event):
    c_x = event.xdata
    c_y = event.ydata
    coords_center.append([c_x,c_y])
    plt.close()

def onclick_radius(event):
    c_x = event.xdata
    c_y = event.ydata
    coords_radius.append([c_x,c_y])
    plt.close()

def in_circle(x, y, x_center, y_center, radius):
    if(sqrt((x_center-x)**2+(y_center-y)**2)<radius):
        return True
    else :
        return False

def compare_cercles(img, center1, radius1, center2, radius2):
    point_intersection = 0
    point_cercle1 = 0
    point_cercle2 = 0
    if(center1[0] != None and center1[1] != None and radius1 != 0 and center2[0] != None and center2[1] != None and radius2 != 0) : 
        for i in range (img.shape[0]):
            for j in range (img.shape[1]):
                if (in_circle(i,j,center1[0], center1[1], radius1)==True and in_circle(i,j,center2[0], center2[1], radius2)==True):
                    point_intersection = point_intersection + 1
                elif (in_circle(i,j,center1[0], center1[1], radius1)==True and in_circle(i,j,center2[0], center2[1], radius2)==False):
                    point_cercle1 = point_cercle1 + 1 
                elif (in_circle(i,j,center2[0], center2[1], radius2)==True and in_circle(i,j,center1[0], center1[1], radius1)==False):
                    point_cercle2 = point_cercle2 + 1
        if(point_intersection*2+point_cercle1+point_cercle2 == 0):
            verification_rate = 0
        else :
            verification_rate = (point_intersection*2)/(point_intersection*2+point_cercle1+point_cercle2)
    elif(center1[0] == None and center1[1] == None and radius1 == 0 and center2[0] == None and center2[1] == None and radius2 == 0):
        verification_rate = 1
    else :
        verification_rate = 0
    return verification_rate


# for i in range (len(imgslog1)) :
#     fig = plt.figure()  
#     imgplot = plt.imshow(imgslog1[i])
#     fig.canvas.mpl_connect('button_press_event', onclick_center)
#     manager = plt.get_current_fig_manager()
#     manager.full_screen_toggle()
#     plt.show() 
# print(coords_center)    
# print("Debut radius")
# for i in range (len(imgslog1)) :
#     fig = plt.figure()  
#     imgplot = plt.imshow(imgslog1[i])
#     fig.canvas.mpl_connect('button_press_event', onclick_radius)
#     manager = plt.get_current_fig_manager()
#     manager.full_screen_toggle()
#     plt.show()
# for i in range (len(imgslog1)) : 
#     if(coords_center[i][0] == None or coords_center[i][1] == None or coords_radius[i][0] == None or coords_radius[i][1] == None) :
#         radius.append(0) 
#     else : 
#         radius_calculated = sqrt((coords_center[i][0]-coords_radius[i][0])**2+(coords_center[i][1]-coords_radius[i][1])**2)
#         radius.append(radius_calculated) 
# print(radius)
for i in range (len(imgslog1)) :
    verification_rates.append(compare_cercles(imgslog1[i], coords_center[i], radius[i], coords_center_algorithm[i], radius_algorithm[i]))
# verification_rates.append(compare_cercles(imgslog1[19], coords_center[19], radius[19], coords_center_algorithm[19], radius_algorithm[19]))
print(verification_rates)
print(statistics.mean(verification_rates))
plt.plot(verification_rates)
plt.show()

# test
# 362 log1
# radius = 81.75
# center = [516.25, 98.75]